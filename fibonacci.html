<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">


    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>

    <!-- redux -->
    <script src="https://unpkg.com/redux@latest/dist/redux.min.js"></script>

    <title>Starter Template</title>
</head>

<body>
    <div class="container">
        <h3>f(n): <span id="answer"></span></h3>
        <div class="form-row align-items-center">
            <div class="col-auto">
                <label class="sr-only" for="number_n">fibonnachi Number</label>
                <input id="number_n" type="number" class="form-control mb-2" placeholder="Number" value="1">
            </div>
            <div class="col-auto">
                <button id="calculate" class="btn btn-primary mb-2">Calculate</button>
            </div>
        </div>
    </div>

    <script>
        function insertFib_n() {
            const n = parseInt(document.getElementById('number_n').value)
            if (typeof n === "number") {
                if (n >= 0) {
                    document.getElementById('answer').innerHTML = log_fib_n(n)
                } else {
                    document.getElementById('answer').innerHTML = "INVALID INPUT"
                }
            }
        }

        document.getElementById('number_n')
            .addEventListener('keypress', function () {
                insertFib_n();
            });

        document.getElementById('calculate')
            .addEventListener('click', function () {
                insertFib_n();
            });

        function naive_fib_n(n) {
            if (n === 0) { return 0; }
            if (n === 1) { return 1; }
            else { return naive_fib_n(n - 1) + naive_fib_n(n - 2); }
        }

        function dynamic_fib_n(n) {
            mem = new Array(n);
            const fib_n = function (n, mem) {
                if (mem[n] != undefined) {
                    return mem[n];
                }
                if (n === 0) {
                    mem[n] = 0;
                    return 0;
                }
                if (n === 1) {
                    mem[n] = 1;
                    return 1;
                }
                const fn1 = fib_n(n - 1, mem);
                const fn2 = fib_n(n - 2, mem);
                if (mem[n - 1] === undefined) {
                    mem[n - 1] = fn1;
                }
                if (mem[n - 2] === undefined) {
                    mem[n - 2] = fn2;
                }
                mem[n] = fn1 + fn2;
                return fn1 + fn2;
            }

            return fib_n(n, mem);
        }

        function log_fib_n(n) {
            const fib_matrix = [
                [1, 1],
                [1, 0]
            ];

            const a00 = fib_matrix[0][0];
            const a01 = fib_matrix[0][1];
            const a10 = fib_matrix[1][0];
            const a11 = fib_matrix[1][1];

            if (n === 0) { return a11; }

            /*
                [a00, a01]   [b00, b01] = [a00*b00+a01*b10, a00*b01+a01*b11] 
                [a10, a11]   [b10, b11]   [a10*b00+a11*b10, a10*b01 + a11*b11]
            */
            let fib_n = fib_matrix;
            for (let i = 1; i < n - 1; i++) {
                const b00 = fib_n[0][0];
                const b01 = fib_n[0][1];
                const b10 = fib_n[1][0];
                const b11 = fib_n[1][1];
                fib_n[0][0] = a00 * b00 + a01 * b10;
                fib_n[0][1] = a00 * b01 + a01 * b11;
                fib_n[1][0] = a10 * b00 + a11 * b10;
                fib_n[1][1] = a10 * b01 + a11 * b11;
            }

            return fib_n[0][0];
        }

    </script>
</body>

</html>
